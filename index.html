
<!DOCTYPE html>
<html lang="en">
<head>
  <title>PyIO</title>
  <meta charset="utf-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js"></script>
    <script src="https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js"></script>
</head>
<body>


<div class="container float-start">
  <div class="row"  style="padding-top: 10px;">
    <div class="col-md-8">
        <form onsubmit="return sendMessage()">
          <textarea style = "resize: none; width: 100%" rows="35" id="message"></textarea>
    </div>
    <div class="col-md-4">
        <img id = "graphimg" src="{{ static_url('round-table.gv.webp') }}" />
    </div>
  </div>
    <div class="row"  style="padding-top: 10px;">
        <div class="col-md-3">
            <button type="submit" class="btn btn-primary">Submit</button>
<!--            <button style="width: 25%">Send</button>-->
            </form>
        </div>
    </div>
</div>

    <script>
    var ws = new WebSocket("ws://localhost:8888/websocket");

    function sendMessage() {
        var messageInput = document.getElementById("message");
        var message = messageInput.value;
        message = message.trim()
        ws.send(JSON.stringify(message));
        return false;
    }

    ws.onmessage = function(evt) {
    console.log(evt)
    newImage = new Image();
    newImage.src = evt.data;
    document.getElementById("graphimg").src=newImage.src;
    };
    </script>
</body>
</html>